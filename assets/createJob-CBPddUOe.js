import"./modulepreload-polyfill-B5Qt9EMX.js";import{S as v,G as x}from"./GLTFLoader-BfuU__Wo.js";async function L(n){try{const t=await fetch("http://localhost:3000/api/saveJob",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();return console.log("Job saved successfully:",e),e}catch(t){throw console.error("Error saving job:",t),t}}const g=new v,k=new x;let p=[],S=new Set;function B(n){k.load(n,t=>{console.log("Model loaded successfully.");const e=t.scene;g.add(e),e.children.forEach(o=>{let l=o.name;A(l),S.add(l.slice(0,3))}),q(),I()},t=>{console.log(t.loaded/t.total*100+"% loaded")},t=>{console.error("An error happened",t)})}function q(){document.querySelectorAll(".component-box").forEach(t=>{t.addEventListener("click",()=>{t.querySelector("label").querySelector("input").checked&&t.classList.add("grey-out"),t.querySelector("label").querySelector("input").checked===!1&&t.classList.remove("grey-out")})})}function A(n){let t=document.querySelector(".components-container"),e=document.createElement("div");e.classList.add("component-box");let o=document.createElement("input");o.type="checkbox",o.classList.add("component-checkbox"),o.dataset.component=n;let l=document.createElement("h3");l.textContent=n,e.appendChild(o),e.appendChild(l);let r=w(" Is Static","form-input");e.appendChild(r);let c=document.createElement("h4");c.textContent="Required Materials";let a=document.createElement("div");a.classList.add("materials-container");let f=h("Add Material","add");e.appendChild(c),e.appendChild(a),e.appendChild(f);let u=document.createElement("h4");u.textContent="Steps";let s=document.createElement("div");s.classList.add("steps-container");let m=h("Add Step","add");e.appendChild(u),e.appendChild(s),e.appendChild(m),f.addEventListener("click",()=>d(a,"enter material...")),m.addEventListener("click",()=>d(s,`Step ${s.childElementCount+1}...`)),t.appendChild(e),e.dataset.filter=n.slice(0,3)}function w(n,t){let e=document.createElement("label"),o=document.createElement("input");return o.type="checkbox",o.classList.add(t),e.appendChild(o),e.appendChild(document.createTextNode(n)),e}function h(n,t){let e=document.createElement("button");return e.textContent=n,e.classList.add(t),e}function d(n,t){let e=document.createElement("input");return e.type="text",e.placeholder=t,e.classList.add("new-input"),e.addEventListener("keypress",o=>{o.key==="Enter"&&(o.preventDefault(),d(n,t).focus())}),n.appendChild(e),e}function I(){const n=document.getElementById("filterButtons");S.forEach(t=>{const e=h(t,"filter-button");e.addEventListener("click",()=>T(t)),n.appendChild(e)})}function T(n){const t=document.querySelectorAll(".component-box"),e=document.querySelectorAll(".filter-button");let o=!1;e.forEach(l=>{l.textContent===n?(l.classList.toggle("active"),o=l.classList.contains("active")):l.classList.remove("active")}),t.forEach(l=>{o?l.classList.toggle("hidden",l.dataset.filter!==n):l.classList.remove("hidden")})}function j(){const n=document.querySelectorAll(".component-box"),t=document.querySelectorAll(".filter-button");n.forEach(e=>e.classList.remove("hidden")),t.forEach(e=>e.classList.remove("active"))}function M(){const n=document.querySelectorAll(".component-checkbox:checked");if(n.length===0){alert("Please select at least one component.");return}const t=prompt("How many materials do you want to add?"),e=parseInt(t);if(isNaN(e)||e<=0){alert("Please enter a valid number greater than 0.");return}for(let o=0;o<e;o++){const l=prompt(`Enter material #${o+1}:`);l&&n.forEach(r=>{const a=r.closest(".component-box").querySelector(".materials-container");d(a,l)})}}function N(){const n=document.querySelectorAll(".component-checkbox:checked");if(n.length===0){alert("Please select at least one component.");return}const t=prompt("How many steps do you want to add?"),e=parseInt(t);if(isNaN(e)||e<=0){alert("Please enter a valid number greater than 0.");return}for(let o=0;o<e;o++){const l=prompt(`Enter step #${o+1}:`);l&&n.forEach(r=>{const a=r.closest(".component-box").querySelector(".steps-container");d(a,l)})}}function P(){const n=document.querySelectorAll(".component-checkbox"),t=document.getElementById("selectAll"),e=t.textContent==="Select All";n.forEach(o=>{o.checked=e}),t.textContent=e?"Deselect All":"Select All"}function U(){const n=document.getElementById("jobTitle").value,t=document.getElementById("unit").value,e=document.getElementById("description").value,o=document.querySelectorAll(".component-box"),l=new URLSearchParams(window.location.search).get("fileUrl");if(!n||!t||!e||!l){alert("Please fill all the fields and upload a 3D file.");return}o.forEach(c=>{let a=c.querySelector(".steps-container"),u=c.querySelector(".materials-container").querySelectorAll(".new-input"),s=a.querySelectorAll(".new-input"),m=c.querySelector("label").querySelector("input").checked,b=c.querySelector("h3").textContent,y=[],E=[];s.forEach(i=>{i.value!=""&&y.push(i.value)}),u.forEach(i=>{i.value!=""&&E.push(i.value)});let C={name:b,static:m,isInstalled:!1,requiredMaterials:E,steps:y};p.push(C),console.log(p)});const r={title:n,unit:t,description:e,allComponents:p,isComplete:!1,model:l};console.log("Job created:",r),L(r).then(()=>{document.querySelector(".job-saved-layer").style.display="flex"}).catch(c=>{console.error("Error saving job:",c),alert("Failed to save job.")})}document.querySelector(".save-button").addEventListener("click",U);document.addEventListener("DOMContentLoaded",()=>{const n=new URLSearchParams(window.location.search).get("fileUrl");n?(document.getElementById("fileInfo").innerHTML=`File uploaded successfully! <br> File URL: <a href="${n}" target="_blank">${n}</a>`,B(n)):document.getElementById("fileInfo").innerHTML="No file uploaded.",document.getElementById("selectAll").addEventListener("click",P),document.getElementById("addMaterialToSelected").addEventListener("click",M),document.getElementById("addStepToSelected").addEventListener("click",N),document.getElementById("clearFilter").addEventListener("click",j)});console.log(p);
